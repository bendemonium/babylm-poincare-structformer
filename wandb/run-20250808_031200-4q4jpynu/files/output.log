Send: curl -X HEAD -H 'Accept: */*' -H 'Accept-Encoding: identity' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: datasets/4.0.0; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0; huggingface_hub/0.34.3; pyarrow/21.0.0; jax/0.6.0' https://huggingface.co/datasets/bendemonium/babylm25_bpe_tokens/resolve/main/README.md
Request a0658118-0af6-4d73-a4a4-a69a08423d86: HEAD https://huggingface.co/datasets/bendemonium/babylm25_bpe_tokens/resolve/main/README.md (authenticated: True)
Send: curl -X HEAD -H 'Accept: */*' -H 'Accept-Encoding: identity' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: datasets/4.0.0; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0; huggingface_hub/0.34.3; pyarrow/21.0.0; jax/0.6.0' https://huggingface.co/datasets/bendemonium/babylm25_bpe_tokens/resolve/e6c2e9185c75c14f37b167b35b73264fc663158d/babylm25_bpe_tokens.py
Request 598615d1-d288-4320-b96e-57197d09b173: HEAD https://huggingface.co/datasets/bendemonium/babylm25_bpe_tokens/resolve/e6c2e9185c75c14f37b167b35b73264fc663158d/babylm25_bpe_tokens.py (authenticated: True)
Send: curl -X HEAD -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'User-Agent: datasets/4.0.0; python/3.10.12; huggingface_hub/0.34.3; pyarrow/21.0.0; torch/2.7.0; tensorflow/2.19.0; jax/0.6.0' https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/bendemonium/babylm25_bpe_tokens/bendemonium/babylm25_bpe_tokens.py
Request d36713b6-02c5-4f11-bd04-5ac2a8116771: HEAD https://s3.amazonaws.com/datasets.huggingface.co/datasets/datasets/bendemonium/babylm25_bpe_tokens/bendemonium/babylm25_bpe_tokens.py (authenticated: False)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/revision/e6c2e9185c75c14f37b167b35b73264fc663158d
Request fdc2d3cd-067f-4fcb-9ed6-c851d07db1e1: GET https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/revision/e6c2e9185c75c14f37b167b35b73264fc663158d (authenticated: True)
Send: curl -X HEAD -H 'Accept: */*' -H 'Accept-Encoding: identity' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: datasets/4.0.0; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0; huggingface_hub/0.34.3; pyarrow/21.0.0; jax/0.6.0' https://huggingface.co/datasets/bendemonium/babylm25_bpe_tokens/resolve/e6c2e9185c75c14f37b167b35b73264fc663158d/.huggingface.yaml
Request 90ce819c-7431-47c0-9acc-1e6ab49ccbcc: HEAD https://huggingface.co/datasets/bendemonium/babylm25_bpe_tokens/resolve/e6c2e9185c75c14f37b167b35b73264fc663158d/.huggingface.yaml (authenticated: True)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: datasets/4.0.0; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' 'https://datasets-server.huggingface.co/info?dataset=bendemonium/babylm25_bpe_tokens'
Request 1464d1cb-8e8c-4c46-b42b-46afc1b35cb0: GET https://datasets-server.huggingface.co/info?dataset=bendemonium/babylm25_bpe_tokens (authenticated: True)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/revision/e6c2e9185c75c14f37b167b35b73264fc663158d
Request 43c8ff5b-86e5-4713-939e-b089f96e8248: GET https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/revision/e6c2e9185c75c14f37b167b35b73264fc663158d (authenticated: True)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' 'https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/tree/e6c2e9185c75c14f37b167b35b73264fc663158d?recursive=False&expand=False'
Request d04c8713-f7f4-46a4-ac31-27ff69af5f0a: GET https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/tree/e6c2e9185c75c14f37b167b35b73264fc663158d?recursive=False&expand=False (authenticated: True)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' 'https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/tree/e6c2e9185c75c14f37b167b35b73264fc663158d/data?recursive=False&expand=False'
Request 4d6a3571-5e60-4c66-8155-d9315bb74650: GET https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/tree/e6c2e9185c75c14f37b167b35b73264fc663158d/data?recursive=False&expand=False (authenticated: True)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/revision/e6c2e9185c75c14f37b167b35b73264fc663158d
Request b49f8897-61f2-4600-9873-f627efc64548: GET https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/revision/e6c2e9185c75c14f37b167b35b73264fc663158d (authenticated: True)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/revision/e6c2e9185c75c14f37b167b35b73264fc663158d
Request 5abddfc5-edcc-48ee-a57a-c00f49148c78: GET https://huggingface.co/api/datasets/bendemonium/babylm25_bpe_tokens/revision/e6c2e9185c75c14f37b167b35b73264fc663158d (authenticated: True)
Send: curl -X HEAD -H 'Accept: */*' -H 'Accept-Encoding: identity' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: datasets/4.0.0; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0; huggingface_hub/0.34.3; pyarrow/21.0.0; jax/0.6.0' https://huggingface.co/datasets/bendemonium/babylm25_bpe_tokens/resolve/e6c2e9185c75c14f37b167b35b73264fc663158d/dataset_infos.json
Request 11f7a755-a57e-4d82-aa9e-9af44a1cb77f: HEAD https://huggingface.co/datasets/bendemonium/babylm25_bpe_tokens/resolve/e6c2e9185c75c14f37b167b35b73264fc663158d/dataset_infos.json (authenticated: True)
Send: curl -X HEAD -H 'Accept: */*' -H 'Accept-Encoding: identity' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0; transformers/4.55.0; session_id/8c66123c6e4e4df488a6737d5ffb9666' https://huggingface.co/gpt2/resolve/main/tokenizer_config.json
Request cbab27fa-554c-42d1-908e-29ae75252897: HEAD https://huggingface.co/gpt2/resolve/main/tokenizer_config.json (authenticated: True)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' 'https://huggingface.co/api/models/gpt2/tree/main/additional_chat_templates?recursive=False&expand=False'
Request ee99e613-211f-4087-9895-28f21adb5654: GET https://huggingface.co/api/models/gpt2/tree/main/additional_chat_templates?recursive=False&expand=False (authenticated: True)
Send: curl -X GET -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate, br' -H 'Connection: keep-alive' -H 'X-Amzn-Trace-Id: ee99e613-211f-4087-9895-28f21adb5654' -H 'authorization: <TOKEN>' -H 'user-agent: unknown/None; hf_hub/0.34.3; python/3.10.12; torch/2.7.0; tensorflow/2.19.0' 'https://huggingface.co/api/models/openai-community/gpt2/tree/main/additional_chat_templates?recursive=False&expand=False'
Request ee99e613-211f-4087-9895-28f21adb5654: GET https://huggingface.co/api/models/openai-community/gpt2/tree/main/additional_chat_templates?recursive=False&expand=False (authenticated: True)
‚ú® Starting training with 1,165,314 training and 1,156,066 validation examples

üîÅ Epoch 1
Training batches:   0%|                                                                                     | 0/9105 [00:00<?, ?it/s]
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/babylm-poincare-structformer/scripts/train.py", line 214, in <module>
    main()
  File "/home/ubuntu/babylm-poincare-structformer/scripts/train.py", line 144, in main
    state, ce_loss, p_loss = train_step(state, batch_jax)
  File "/home/ubuntu/babylm-poincare-structformer/scripts/train.py", line 62, in train_step
    return state, float(ce_loss), float(poincare_loss)
jax.errors.ConcretizationTypeError: Abstract tracer value encountered where concrete value is expected: traced array with shape float32[]
The problem arose with the `float` function. If trying to convert the data type of a value, try using `x.astype(float)` or `jnp.array(x, float)` instead.
The error occurred while tracing the function train_step at /home/ubuntu/babylm-poincare-structformer/scripts/train.py:47 for jit. This concrete value was not available in Python because it depends on the values of the arguments state.params['head']['bias'], state.params['head']['kernel'], state.params['layers_0']['SelfAttention_0']['key']['bias'], state.params['layers_0']['SelfAttention_0']['key']['kernel'], state.params['layers_0']['SelfAttention_0']['out']['bias'], state.params['layers_0']['SelfAttention_0']['out']['kernel'], state.params['layers_0']['SelfAttention_0']['query']['bias'], state.params['layers_0']['SelfAttention_0']['query']['kernel'], state.params['layers_0']['SelfAttention_0']['value']['bias'], state.params['layers_0']['SelfAttention_0']['value']['kernel'], state.params['layers_1']['SelfAttention_0']['key']['bias'], state.params['layers_1']['SelfAttention_0']['key']['kernel'], state.params['layers_1']['SelfAttention_0']['out']['bias'], state.params['layers_1']['SelfAttention_0']['out']['kernel'], state.params['layers_1']['SelfAttention_0']['query']['bias'], state.params['layers_1']['SelfAttention_0']['query']['kernel'], state.params['layers_1']['SelfAttention_0']['value']['bias'], state.params['layers_1']['SelfAttention_0']['value']['kernel'], state.params['layers_2']['SelfAttention_0']['key']['bias'], state.params['layers_2']['SelfAttention_0']['key']['kernel'], state.params['layers_2']['SelfAttention_0']['out']['bias'], state.params['layers_2']['SelfAttention_0']['out']['kernel'], state.params['layers_2']['SelfAttention_0']['query']['bias'], state.params['layers_2']['SelfAttention_0']['query']['kernel'], state.params['layers_2']['SelfAttention_0']['value']['bias'], state.params['layers_2']['SelfAttention_0']['value']['kernel'], state.params['layers_3']['SelfAttention_0']['key']['bias'], state.params['layers_3']['SelfAttention_0']['key']['kernel'], state.params['layers_3']['SelfAttention_0']['out']['bias'], state.params['layers_3']['SelfAttention_0']['out']['kernel'], state.params['layers_3']['SelfAttention_0']['query']['bias'], state.params['layers_3']['SelfAttention_0']['query']['kernel'], state.params['layers_3']['SelfAttention_0']['value']['bias'], state.params['layers_3']['SelfAttention_0']['value']['kernel'], state.params['layers_4']['SelfAttention_0']['key']['bias'], state.params['layers_4']['SelfAttention_0']['key']['kernel'], state.params['layers_4']['SelfAttention_0']['out']['bias'], state.params['layers_4']['SelfAttention_0']['out']['kernel'], state.params['layers_4']['SelfAttention_0']['query']['bias'], state.params['layers_4']['SelfAttention_0']['query']['kernel'], state.params['layers_4']['SelfAttention_0']['value']['bias'], state.params['layers_4']['SelfAttention_0']['value']['kernel'], state.params['layers_5']['SelfAttention_0']['key']['bias'], state.params['layers_5']['SelfAttention_0']['key']['kernel'], state.params['layers_5']['SelfAttention_0']['out']['bias'], state.params['layers_5']['SelfAttention_0']['out']['kernel'], state.params['layers_5']['SelfAttention_0']['query']['bias'], state.params['layers_5']['SelfAttention_0']['query']['kernel'], state.params['layers_5']['SelfAttention_0']['value']['bias'], state.params['layers_5']['SelfAttention_0']['value']['kernel'], state.params['ln']['bias'], state.params['ln']['scale'], state.params['pos_embed'], state.params['token_embed']['embedding'], batch['attention_mask'], and batch['input_ids'].

See https://docs.jax.dev/en/latest/errors.html#jax.errors.ConcretizationTypeError
